// Test with more methods like JsonParser
class Test {
    init(s) {
        this.str = s;
        this.pos = 0;
        this.len = len(s);
    }
    
    peek() {
        if (this.pos >= this.len) return "";
        return substr(this.str, this.pos, 1);
    }
    
    consume() {
        if (this.pos >= this.len) return "";
        let c = substr(this.str, this.pos, 1);
        this.pos = this.pos + 1;
        return c;
    }
}

func main() {
    let q = substr("\"", 1, 1);
    
    // Build exact JSON string
    let json_str = "{" + q + "users" + q + ":[";
    for (let i = 0; i < 500; i = i + 1) {
        json_str = json_str + "{" + q + "id" + q + ":" + q + to_string(i) + q + "," + q + "name" + q + ":" + q + "User" + to_string(i) + q + "}";
        json_str = json_str + ",";
    }
    json_str = substr(json_str, 0, len(json_str) - 1);
    json_str = json_str + "]}";
    
    print("JSON Length: " + to_string(len(json_str)));
    
    let t = Test(json_str);
    print("Instance created");
    
    let c1 = t.peek();
    print("Peek: " + c1);
    
    let c2 = t.consume();
    print("Consumed: " + c2);
}

main();
